id: emqx-default-login

info:
  name: Emqx Default Admin Login
  author: For3stCo1d
  severity: high
  verifed: true
  description: |-
    Emqx default admin credentials were discovered.
    shodan: http.favicon.hash:"-670975485"
    fofa: icon_hash="-670975485"
  tags: emqx,default-login
  created: 2023/06/24

rules:
  r0:
    request:
      method: POST
      path: /api/v4/auth
      headers:
        Content-Type: application/json
      body: |
        {"username":"admin","password":"public"}
    expression: |
      response.status == 200 && 
      response.body == bytes("{\"code\":0}")
  r1:
    request:
      method: POST
      path: /api/v5/login
      headers:
        Content-Type: application/json
      body: |
        {"username":"admin","password":"public"}
    expression: |
      response.status == 200 && 
      response.content_type.contains("application/json") &&
      response.body.bcontains(b'"token":') &&
      response.body.bcontains(b'"license":') &&
      response.body.bcontains(b'"version":')
expression: r0() || r1()
