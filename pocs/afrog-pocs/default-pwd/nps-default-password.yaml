id: nps-default-password

info:
  name: Nps Default Password
  author: pikpikcu
  severity: high
  verified: true
  description: |-
    Nps default admin login credentials were detected.
  reference:
    - https://www.tenable.com/plugins/nessus/105246
  tags: default-login,nps
  created: 2023/06/24

rules:
  r0:
    request:
      method: POST
      path: /login/verify
      body: username=admin&password=123
    expression: |
      response.status == 200 && response.content_type.contains("application/json") && response.body.bcontains(b'"msg": "login success"') && response.body.bcontains(b'"status": 1')
expression: r0()
