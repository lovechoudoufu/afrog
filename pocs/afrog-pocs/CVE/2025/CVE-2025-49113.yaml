id: CVE-2025-49113

info:
  name: Roundcube Webmail - Remote Code Execution
  author: rxerium
  severity: critical
  verified: true
  description: |-
    Roundcube Webmail 在 1.5.10 之前和 1.6.x 在 1.6.11 之前的版本中，允许经过身份验证的用户远程执行代码，因为 URL 中的_from 参数在 program/actions/settings/upload.php 中没有经过验证，导致 PHP 对象反序列化。
    fofa: "Roundcube Webmail" && title=="Roundcube Webmail :: 欢迎使用 Roundcube Webmail"
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-49113
  tags: roundcube,zeroday

rules:
  r0:
    request:
      method: GET
      path: /
    expression: |
      response.status == 200 &&
      response.body.ibcontains(b'<title>Roundcube Webmail') &&
      (response.body.bcontains(b'"rcversion":10500') || 
      response.body.bcontains(b'"rcversion":10501') ||
      response.body.bcontains(b'"rcversion":10502') ||
      response.body.bcontains(b'"rcversion":10503') ||
      response.body.bcontains(b'"rcversion":10504') ||
      response.body.bcontains(b'"rcversion":10505') ||
      response.body.bcontains(b'"rcversion":10506') ||
      response.body.bcontains(b'"rcversion":10507') ||
      response.body.bcontains(b'"rcversion":10508') ||
      response.body.bcontains(b'"rcversion":10509') ||
      response.body.bcontains(b'"rcversion":10600') ||
      response.body.bcontains(b'"rcversion":10601') ||
      response.body.bcontains(b'"rcversion":10602') ||
      response.body.bcontains(b'"rcversion":10603') ||
      response.body.bcontains(b'"rcversion":10604') ||
      response.body.bcontains(b'"rcversion":10605') ||
      response.body.bcontains(b'"rcversion":10606') ||
      response.body.bcontains(b'"rcversion":10607') ||
      response.body.bcontains(b'"rcversion":10608') ||
      response.body.bcontains(b'"rcversion":10609') ||
      response.body.bcontains(b'"rcversion":10610') )
    extractors:
      - type: regex
        extractor:
          search: '"\"rcversion\":(?P<webmail>[0-9]{5}),".bsubmatch(response.body)'
          webmail: search["webmail"]
expression: r0()
