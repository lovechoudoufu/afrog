id: docker-registry

info:
  name: Docker Registry Listing
  author: zan8in
  severity: medium
  tags: docker,registry,enum
  created: 2023/05/16

rules:
  r0:
    request:
      method: GET
      path: /v2/_catalog
      follow_redirects: true
    expression: response.status == 200 && response.content_type.contains("application/json") && response.body.bcontains(b'"repositories":')
expression: r0()
