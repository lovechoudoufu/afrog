import{b as E,h as g,a as A,ag as k,ah as q,X as x,E as z,d as F,z as c,ai as R,f as y,aj as S,F as T,ak as C,C as N}from"./CWza-o0X.js";function X(e,r,...t){var s=e,n=c,i;E(()=>{n!==(n=r())&&(i&&(R(i),i=null),i=F(()=>n(s,...t)))},z),g&&(s=y)}function D(e){return(r,...t)=>{var s=e(...t),n;if(g)n=y,A();else{var i=s.render().trim(),f=k(i);n=S(f),r.before(n)}const u=s.setup?.(n);q(n,n),typeof u=="function"&&x(u)}}function m(e,r,t){if(e==null)return r(void 0),t&&t(void 0),c;const s=T(()=>e.subscribe(r,t));return s.unsubscribe?()=>s.unsubscribe():s}const b=[];function j(e,r){return{subscribe:B(e,r).subscribe}}function B(e,r=c){let t=null;const s=new Set;function n(u){if(C(e,u)&&(e=u,t)){const o=!b.length;for(const a of s)a[1](),b.push(a,e);if(o){for(let a=0;a<b.length;a+=2)b[a][0](b[a+1]);b.length=0}}}function i(u){n(u(e))}function f(u,o=c){const a=[u,o];return s.add(a),s.size===1&&(t=r(n,i)||c),u(e),()=>{s.delete(a),s.size===0&&t&&(t(),t=null)}}return{set:n,update:i,subscribe:f}}function G(e,r,t){const s=!Array.isArray(e),n=s?[e]:e;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const i=r.length<2;return j(t,(f,u)=>{let o=!1;const a=[];let p=0,d=c;const h=()=>{if(p)return;d();const l=r(s?a[0]:a,f,u);i?f(l):d=typeof l=="function"?l:c},v=n.map((l,_)=>m(l,w=>{a[_]=w,p&=~(1<<_),o&&h()},()=>{p|=1<<_}));return o=!0,h(),function(){N(v),d(),o=!1}})}function H(e){let r;return m(e,t=>r=t)(),r}export{m as a,D as c,G as d,H as g,X as s,B as w};
