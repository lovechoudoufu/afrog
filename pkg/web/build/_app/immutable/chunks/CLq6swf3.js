import{g as h,a as u}from"./CiC7uZ2I.js";const l="/api";class r extends Error{constructor(t,e,o){super(o),this.status=t,this.response=e,this.name="ApiError"}}class p{baseUrl;constructor(t=l){this.baseUrl=t}async request(t,e={}){const o=`${this.baseUrl}${t}`,a=h(),n={headers:{"Content-Type":"application/json",...e.headers},...e};a&&(n.headers={...n.headers,Authorization:`Bearer ${a}`});try{const s=await fetch(o,n);if(s.status===401)throw u.removeToken(),new r(401,null,"登录过期，请重新登录");if(!s.ok){const i=await s.json().catch(()=>({}));throw new r(s.status,i,i.message||`HTTP ${s.status}: ${s.statusText}`)}return await s.json()}catch(s){throw s instanceof r?s:new r(0,null,"网络错误，请检查连接后重试")}}post(t,e){return this.request(t,{method:"POST",body:e?JSON.stringify(e):void 0})}get(t){return this.request(t,{method:"GET"})}async login(t){return this.post("/login",{password:t})}async loadVulns(){return this.get("/vulns")}async loadPocStats(){return this.get("/pocs/stats")}}const d=new p;export{r as A,d as a};
