import{q as E,v as h,w as k,ak as q,al as A,a0 as x,E as R,y as S,M as c,am as T,B as y,an as z,k as B,ao as F,i as N}from"./DTlqaqqF.js";function j(e,r,...n){var s=e,t=c,i;E(()=>{t!==(t=r())&&(i&&(T(i),i=null),i=S(()=>t(s,...n)))},R),h&&(s=y)}function D(e){return(r,...n)=>{var s=e(...n),t;if(h)t=y,k();else{var i=s.render().trim(),f=q(i);t=z(f),r.before(t)}const u=s.setup?.(t);A(t,t),typeof u=="function"&&x(u)}}function m(e,r,n){if(e==null)return r(void 0),n&&n(void 0),c;const s=B(()=>e.subscribe(r,n));return s.unsubscribe?()=>s.unsubscribe():s}const b=[];function C(e,r){return{subscribe:M(e,r).subscribe}}function M(e,r=c){let n=null;const s=new Set;function t(u){if(F(e,u)&&(e=u,n)){const o=!b.length;for(const a of s)a[1](),b.push(a,e);if(o){for(let a=0;a<b.length;a+=2)b[a][0](b[a+1]);b.length=0}}}function i(u){t(u(e))}function f(u,o=c){const a=[u,o];return s.add(a),s.size===1&&(n=r(t,i)||c),u(e),()=>{s.delete(a),s.size===0&&n&&(n(),n=null)}}return{set:t,update:i,subscribe:f}}function G(e,r,n){const s=!Array.isArray(e),t=s?[e]:e;if(!t.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const i=r.length<2;return C(n,(f,u)=>{let o=!1;const a=[];let p=0,d=c;const g=()=>{if(p)return;d();const l=r(s?a[0]:a,f,u);i?f(l):d=typeof l=="function"?l:c},v=t.map((l,_)=>m(l,w=>{a[_]=w,p&=~(1<<_),o&&g()},()=>{p|=1<<_}));return o=!0,g(),function(){N(v),d(),o=!1}})}function H(e){let r;return m(e,n=>r=n)(),r}export{m as a,D as c,G as d,H as g,j as s,M as w};
