import{a5 as s,a3 as c,a6 as i,a2 as o,j as u}from"./DsmM-oav.js";const n="jwt_token";function d(e){localStorage.setItem(n,e)}function f(){return localStorage.getItem(n)}function k(){localStorage.removeItem(n)}function r(){const e=f();if(!e)return!1;try{return!(s(e).exp*1e3<Date.now())}catch(a){return console.error("Invalid token:",a),!1}}let t=c(i(r()));function l(e){d(e),o(t,!0)}function g(){k(),o(t,!1)}const p={get authenticated(){return u(t)},setToken:l,removeToken:g};window.addEventListener("storage",e=>{e.key==="jwt_token"&&o(t,r(),!0)});export{p as a,f as g};
